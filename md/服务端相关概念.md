# 服务端相关概念

## 项目集群和分布式  [参考](https://www.zhihu.com/question/20004877)

通俗理解： 一起干同样的事叫集群，分工合作的叫分布式

分布式：分布式是指通过网络连接的多个组件，通过交换信息协作而形成的系统；分布式是个工作方式。
集群：是指同一种组件的多个实例，形成的逻辑上的整体；集群是个物理形态


+ 实例：
  1、我有订单和商品管理两个子系统，分别部署在两台服务器上，通过webservice交互信息，这个叫做分布式。为了保证容错和高可用，订单管理系统部署在两台服务器上做个集群，商品管理系统部署在两台服务器上做个集群。 

  2、或者是一台部署订单和商品管理系统，另一台服务器也是一样的部署。两台机器上的订单管理系统形成一个订单集群，商品管理系统也是一样。这样就用不着四台服务器了，省钱。


## 负载均衡

  背景：随着业务量的提高，现有网络的各个核心部分访问量和数据流量的快速增长，其处理能力和计算强度也相应地增大，使得单一的服务器设备根本无法承担。在此情况下，如果扔掉现有设备去做大量的硬件升级，这样将造成现有资源的浪费，而且如果再面临下一次业务量的提升时，这又将导致再一次硬件升级的高额成本投入，甚至性能再卓越的设备也不能满足当前业务量增长的需求

  实现原理：负载均衡技术通过设置虚拟服务器IP（VIP），将后端多台真实服务器的应用资源虚拟成一台高性能的应用服务器，通过负载均衡算法，将用户的请求转发给后台内网服务器，内网服务器将请求的响应返回给负载平衡器，负载平衡器再将响应发送到用户。

优点：
+ 1、安全：向互联网用户隐藏了内网结构，阻止了用户直接访问后台（内网）服务器，使得服务器更加安全，可以阻止对核心网络栈和运行在其它端口服务的攻击。
+ 2、可靠：负载均衡设备（软件或硬件）会持续的对服务器上的应用状态进行检查，并自动对无效的应用服务器进行隔离，
+ 3、高性能，可扩展：可以通过添加机器来满足大型网站服务的处理能力

负载均衡算法：

- 1、轮询：将请求顺序循环地发到每个服务器。当其中某个服务器发生故障，AX就把其从顺序循环队列中拿出，不参加下一次的轮询，直到其恢复正常。
- 2、比率：给每个服务器分配一个加权值为比例，根椐这个比例，把用户的请求分配到每个服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。
- 3、优先权：给所有服务器分组，给每个组定义优先权，将用户的请求分配给优先级最高的服务器组（在同一组内，采用预先设定的轮询或比率算法，分配用户的请求）；当最高优先级中所有服务器或者指定数量的服务器出现故障，AX将把请求送给次优先级的服务器组。这种方式，实际为用户提供一种热备份的方式。
- 4、最少连接数： AX会记录当前每台服务器或者服务端口上的连接数，新的连接将传递给连接数最少的服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。
- 5、最快响应时间：新的连接传递给那些响应最快的服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常
- 6、哈希算法： 将客户端的源地址，端口进行哈希运算，根据运算的结果转发给一台服务器进行处理，当其中某个服务器发生故障，就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。
- 7、基于数据包的内容分发：例如判断HTTP的URL，如果URL中带有.jpg的扩展名，就把数据包转发到指定的服务器。
