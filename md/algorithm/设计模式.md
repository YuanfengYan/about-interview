# è®¾è®¡æ¨¡å¼


## ä¸€ã€å‘å¸ƒè®¢é˜…æ¨¡å¼

#### ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…

å‘å¸ƒ-è®¢é˜…æ¨¡å¼é‡Œé¢åŒ…å«äº†ä¸‰ä¸ªæ¨¡å—ï¼Œ<font color="red">å‘å¸ƒè€…</font>ï¼Œ<font color="red">è®¢é˜…è€…</font>å’Œ<font color="red">äº‹ä»¶è°ƒåº¦ä¸­å¿ƒ</font>

1. <b>äº‹ä»¶è°ƒåº¦ä¸­å¿ƒ</b> å³ä¸€ä¸ªobject eventObj:{}
2. <b>è®¢é˜…è€…</b>è®¢é˜…è€…è®¢é˜…äº‹ä»¶ï¼Œå³åœ¨eventObjä¸­å·²äº‹ä»¶ç±»å‹å‘½åçš„æ•°ç»„ä¸­æ¨å…¥äº‹ä»¶ï¼ˆcallbackï¼‰ å¦‚ï¼ševentObj.click.push(fn) å¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª
2. <b>å‘å¸ƒè€…</b>å‘å¸ƒäº‹ä»¶æ—¶ï¼Œé€šè¿‡äº‹ä»¶åæ‰¾åˆ°å¯¹åº”çš„eventObjä¸­çš„å›è°ƒå‡½æ•°æ•°ç»„ ï¼Œéå†æ‰§è¡Œcallback

>ç¼ºç‚¹: äº‹ä»¶ç±»å‹è¶Šæ¥è¶Šå¤šï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œéœ€è¦è€ƒè™‘å‘½åçš„è§„èŒƒ

#### ä»£ç å®ç°

```javascript
class Event{
    constructor(){}
    // é¦–å…ˆå®šä¹‰ä¸€ä¸ªäº‹ä»¶å®¹å™¨ï¼Œç”¨æ¥è£…äº‹ä»¶æ•°ç»„ï¼ˆå› ä¸ºè®¢é˜…è€…å¯ä»¥æ˜¯å¤šä¸ªï¼‰
    handlers = {}
    addEvent(type,fn){
        if(this.handlers[type]){
            this.handlers[type].push(fn)
        }else{
            this.handlers[type]=[fn]
        } 
    }
    dispatchEvent(type){
        let list = this.handlers[type]
        for(let i = 0 ;i<list.length ;i++){
            list[i].call(this)
        }
    }

}
 var myevent = new Event()

 myevent.addEvent('click',function(){
     console.log('1')
 })
  myevent.addEvent('click',function(){
     console.log('2')
 })
 myevent.dispatchEvent('click')

```

## äºŒã€è§‚å¯Ÿè€…æ¨¡å¼

#### ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼

è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚

<font color='red'>ç›®æ ‡å¯¹è±¡(Subject):</font>

+ æ”¶é›†è§‚å¯Ÿè€…æ•°ç»„ï¼Œä¸€ä¸ªç›®æ ‡å¯¹è±¡å¯ä»¥è¢«å¤šä¸ªè§‚å¯Ÿè€…è§‚å¯Ÿ
+ ç›®æ ‡å¯¹è±¡è¦æä¾›è§‚å¯Ÿè€…æ³¨å†Œå’Œé€€è®¢
+ å½“ç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶å€™ï¼Œç›®æ ‡å¯¹è±¡è´Ÿè´£é€šçŸ¥æ‰€æœ‰æ³¨å†Œçš„ã€æœ‰æ•ˆçš„è§‚å¯Ÿè€…

<font color='red'>è§‚å¯Ÿè€…(Observer)</font>

+ æä¾›ä¸€ä¸ªupdateæ–¹æ³•ï¼Œæ‰§è¡Œè‡ªå®šä¹‰çš„ä¸šåŠ¡ä»£ç 

#### ä»£ç å®ç°

```javascript
// ä¸»é¢˜ï¼Œæ¥æ”¶çŠ¶æ€å˜åŒ–ï¼Œè§¦å‘æ¯ä¸ªè§‚å¯Ÿè€…
class Subject {
  constructor() {
      this.state = 0
      this.observers = []
  }
  getState() {
      return this.state
  }
  setState(state) {
      this.state = state
      this.notifyAllObservers()
  }
  attach(observer) {
      this.observers.push(observer)
  }
  notifyAllObservers() {
      this.observers.forEach(observer => {
          observer.update()
      })
  }
}

// è§‚å¯Ÿè€…ï¼Œç­‰å¾…è¢«è§¦å‘
class Observer {
  constructor(name, subject) {
      this.name = name
      this.subject = subject
      this.subject.attach(this)
  }
  update() {
      console.log(`${this.name} update, state: ${this.subject.getState()}`)
  }
}

// æµ‹è¯•ä»£ç 
let s = new Subject()
let o1 = new Observer('o1', s)
let o2 = new Observer('o2', s)
let o3 = new Observer('o3', s)

s.setState(1)
s.setState(2)
s.setState(3)

```

## ä¸‰ã€å•ä¾‹è®¾è®¡æ¨¡å¼

### ä»€ä¹ˆæ˜¯å•ä¾‹è®¾è®¡

+ åˆ›å»ºå®Œä¹‹åï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä¹‹åå†æ€ä¹ˆåˆ›å»ºï¼Œéƒ½æ˜¯è¿™ä¸€ä¸ªï¼Œæ–¹ä¾¿å®ä¾‹ç®¡ç†ï¼Œæä¾›äº†å¯¹å®ä¾‹çš„å—æ§è®¿é—®
+ å•ä¾‹æ¨¡å¼æŒ‡çš„æ˜¯å½“ç”¨classåœ¨ç”Ÿæˆå®ä¾‹çš„æ—¶å€™ï¼Œåªä¼šç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªåœ¨ç™»å½•æ³¨å†Œå¼¹æ¡†ï¼ŒWebSocketå®ä¾‹ã€EventPubSubäº‹ä»¶ç›‘å¬

```javascript
```

æ€æƒ³åŒå¯¹è±¡æ± 

### ä»£ç å®ç°

```javascript
function Singledog(){  //åˆ›å»ºäº†ä¸€ä¸ªå•èº«ç‹—æ„é€ å‡½æ•°ï¼Œç„¶è€Œå…¨ä¸–ç•Œï¼Œåªæœ‰æˆ‘æ˜¯å•ç”Ÿç‹—
    var me = {name:"David", age:20}  //ç¨å¾®ä»‹ç»ä¸€ä¸‹è‡ªå·±çš„èº«ä¸–
    Singledog = function () {   //åˆ›å»ºå®Œä¹‹åï¼Œç›´æ¥æŠŠè¿™ä¸ªæ„é€ å‡½æ•°æ‚„æ‚„çš„é‡å†™äº†ï¼Œåˆ©ç”¨é—­åŒ…åŸç†ï¼Œå·å·çš„è®©å…¨ä¸–ç•Œçš„å•èº«ç‹—å˜æˆæˆ‘ä¸€ä¸ª
        return me;
    }
    return me;
}

// ç¤ºä¾‹2 å•ä¾‹é…åˆå‘å¸ƒè®¢é˜…
export default class EventPubSub {
  static instance = null;
  static getInstance() {
    // this.instance  ç­‰ä»·äº  EventPubSub.instance
      if (!this.instance) {//æ³¨æ„ é™æ€æ–¹æ³•é‡Œé¢çš„thisæŒ‡å‘çš„æ˜¯EventPubSubï¼Œå…¬æœ‰æ–¹æ³•ã€constructoræ„é€ å™¨é‡Œçš„thisæŒ‡å‘çš„æ˜¯å®ä¾‹
          this.instance = new EventPubSub()
      };
      return this.instance;
  }
  constructor() {

    /**
     * å­˜æ”¾äº‹ä»¶å’Œå¯¹åº”çš„å¤„ç†æ–¹æ³•
     */
    this.handles = {};
  }

  /**
   * æ³¨å†Œäº‹ä»¶ä¼ å…¥äº‹ä»¶ç±»å‹typeå’Œäº‹ä»¶å¤„ç†handle
   * @param {*} type
   * @param {*} handle
   */
  on(type, handle) {
    if (!this.handles[type]) {
      this.handles[type] = [];
    }
    this.handles[type].push(handle);
  }
  
  /**
   * å‘å¸ƒäº‹ä»¶
   * @returns
   */
  emit() {
    //é€šè¿‡ä¼ å…¥å‚æ•°è·å–äº‹ä»¶ç±»å‹
    //å°†argumentsè½¬ä¸ºçœŸæ•°ç»„
    var type = Array.prototype.shift.call(arguments);
    if (!this.handles[type]) {
      return false;
    }
    for (var i = 0; i < this.handles[type].length; i++) {
      var handle = this.handles[type][i]; //æ‰§è¡Œäº‹ä»¶
      handle.apply(this, arguments);
    }
  }
  
  /**
   * å–æ¶ˆè®¢é˜…
   * @param {*} type
   * @param {*} handle
   */
  off(type, handle) {
    let handles = this.handles[type];
    if (handles) {
      if (!handle) {
        handles.length = 0; //æ¸…ç©ºæ•°ç»„
      } else {
        for (var i = 0; i < handles.length; i++) {
          var _handle = handles[i];
          if (_handle === handle) {
            //ä»æ•°ç»„ä¸­åˆ é™¤
            handles.splice(i, 1);
          }
        }
      }
    }
  }
}

```

## å››ã€AOPè£…é¥°è€…æ¨¡å¼

### ä»€ä¹ˆæ˜¯AOPè£…é¥°è€…æ¨¡å¼

é€šä¿—ç†è§£ï¼šæ˜¯æŠŠä¸€ä¸ªå‡½æ•°â€œåŠ¨æ€ç»‡å…¥â€åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¹‹ä¸­

[vueä¸­ä½¿ç”¨è£…é¥°å™¨å®ç°AOPç¼–ç¨‹](https://www.jianshu.com/p/208904b34d8f)
- ç›®å‰è¿˜å¤„ææ¡ˆé˜¶æ®µï¼Œ

[ECMAScriptè£…é¥°å™¨](https://es6.ruanyifeng.com/#docs/decorator)

[Typescriptè£…é¥°å™¨è¯­æ³•](https://www.tslang.cn/docs/handbook/decorators.html#method-decorators)

[ä¸€èµ·èŠèŠJavaScriptè£…é¥°å™¨ï¼ˆdecoratorï¼‰](https://www.jianshu.com/p/91df93aa3250)

### ä»£ç å®ç°
```javascript
Function.prototype.before = function(fn){
  let self = this//å­˜å‚¨Functionå®ä¾‹---å³è¢«æ’å…¥çš„å‡½æ•° 
  return function(){
    fn.apply(self,arguments);
    return self.apply(this,arguments) //è¿™é‡Œçš„thisæŒ‡å‘çš„æ˜¯è¢«æ’å…¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶çš„è¿è¡Œç¯å¢ƒ
  }
}
// åŒç†å¯ä»¥å†™after,around
Function.prototype.after = function (afterfn) {
  let _self = this;
  return function () {
    let ret = _self.apply(this, arguments);
    afterfn.apply(this, arguments);
    return ret;
  };
};
Function.prototype.around = function (beforefn, afterfn) {
  let _self = this;
  return function () {
    beforefn.apply(this, arguments);
    let ret = _self.apply(this, arguments);
    afterfn.apply(this, arguments);
    return ret;
  };
};

//ä¸šåŠ¡ä¸»æ¨¡å—
let myFun = function(){
    console.log("æ‰§è¡Œä¸šåŠ¡é€»è¾‘");
}
let fun =  myFun.before(function(){
    
    console.log("æ¨¡å—çš„é¢„å¤„ç†");
 
}).after(function(){
 
    console.log("æ¨¡å—çš„åå¤„ç†");
 
});
 

```

``` javaScript
// è‡ªå®šä¹‰è£…é¥°å™¨
// è¿™æ˜¯ç¬¬ä¸‰æ–¹æ’ä»¶ é›†æˆäº†å¸¸ç”¨åŸºç¡€çš„è£…é¥°å™¨
import debounce from 'lodash-decorators/debounce';
import Util from "@/utils/index"
function mydebounce(wait:number) {
  return function(target:Object,name?:string, descriptor?:any) {
    descriptor.value = Util.debounce(descriptor.value, wait)
  }
}

// ç±»å±æ€§è£…é¥°å™¨å¯ä»¥ç”¨åœ¨ç±»çš„å•ä¸ªæˆå‘˜ä¸Šï¼Œæ— è®ºæ˜¯ç±»çš„å±æ€§ã€æ–¹æ³•ã€get/setå‡½æ•°ã€‚è¯¥è£…é¥°å™¨å‡½æ•°æœ‰3ä¸ªå‚æ•°ï¼š
/**
 * ç±»å±æ€§è£…é¥°å™¨ readonly
 * @param target  æˆå‘˜æ‰€åœ¨çš„ç±»
 * @param name ç±»æˆå‘˜çš„åå­—
 * @param descriptor  å±æ€§æè¿°ç¬¦ã€‚
 * @returns 
 */
function readonly(target:Object, name?:string, descriptor?:any) {
  descriptor.writable = false;
  console.log(target,name,descriptor)
  return descriptor;
}


export default class Example {
  @mydebounce(1000)
  a() {
    console.log(11)
  }
  @debounce(1000)
  a2() {
    console.log(22)
  }

  @readonly
  b() {}
}



```

### åº”ç”¨åœºæ™¯ï¼š

1. åœ¨ä»£ç ä¸­æ·»åŠ åŸ‹ç‚¹ï¼Œ
2. å‚æ•°æ ¡éªŒã€æƒé™æ£€æµ‹ã€ç¡®è®¤æç¤ºç­‰è§„åˆ™ç›¸åŒçš„ä¸€äº›è¡¨è±¡å¤„ç†

## äº” çŠ¶æ€æ¨¡å¼

[å‚è€ƒé“¾æ¥-jsè®¾è®¡æ¨¡å¼ã€è¯¦è§£ã€‘â€”â€” çŠ¶æ€æ¨¡å¼](https://blog.csdn.net/weixin_41192489/article/details/116150591)
### åº”ç”¨åœºæ™¯ï¼š[å‚è€ƒçš„åº”ç”¨åœºæ™¯](https://blog.csdn.net/weixin_39760689/article/details/111615145)

  1ã€åœ¨ç»„ä»¶æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒæŸäº›å¯¹è±¡çš„çŠ¶æ€ç»å¸¸é¢ä¸´å˜åŒ–ï¼Œé€šå¸¸è¦ä½¿ç”¨è®¸å¤š if else è¯­å¥æ¥åˆ¤æ–­å¯¹è±¡çš„çŠ¶æ€åˆ°åº•å¦‚ä½•

  2ã€ä¸€ä¸ªç”±ä¸€ä¸ªæˆ–å¤šä¸ªåŠ¨æ€å˜åŒ–çš„å±æ€§å¯¼è‡´å‘ç”Ÿä¸åŒè¡Œä¸ºçš„å¯¹è±¡ï¼Œåœ¨ä¸å¤–éƒ¨äº‹ä»¶äº§ç”Ÿäº’åŠ¨æ—¶ï¼Œå…¶å†…éƒ¨çŠ¶æ€å°±ä¼šæ”¹å˜ï¼Œä»è€Œä½¿å¾—ç³»ç»Ÿçš„è¡Œä¸ºä¹Ÿéšä¹‹å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯æœ‰çŠ¶æ€çš„å¯¹è±¡

### å®šä¹‰

å½“ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šå¯¼è‡´å…¶è¡Œä¸ºçš„æ”¹å˜ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯æ”¹å˜äº†å¯¹è±¡ã€‚


### ä¼˜ç¼ºç‚¹

  ä¼˜ç‚¹ï¼šæŠŠæ–¹æ³•å¤§æ‹†å°ï¼Œä¾¿äºè§‚å¯Ÿã€åç»­å¢å‡çŠ¶æ€
  ç¼ºç‚¹ï¼šäº§ç”Ÿè®¸å¤šstateå¯¹è±¡å¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼ˆå¯ç”¨äº«å…ƒæ¨¡å¼ä¼˜åŒ–ï¼‰
### è®¾è®¡æ€è·¯

+ æŠŠçŠ¶æ€ä»ä¸»ä½“ï¼ˆContextï¼‰æŠ½ç¦»å‡ºæ¥ï¼Œåˆ†ä¸º Context å’Œ State ,çŠ¶æ€å˜åŒ–é€šè¿‡Context,å§”æ‰˜Stateè¿›è¡Œå˜åŒ–

+ åœ¨ä»£ç å°è£…æ—¶ï¼Œä¼˜å…ˆ**æŠŠäº‹ç‰©çš„æ¯ç§çŠ¶æ€éƒ½å°è£…æˆå•ç‹¬çš„ç±»ã€‚**

### ä»£ç å®ç°

```javascript
// äº¤é€šä¿¡å·ç¯ä¸åŒé¢œè‰²çš„å˜åŒ–
// çŠ¶æ€
class State {
    constructor(color) {
        this.color = color
    }
    // åœ¨è¿™è¿›è¡Œå¤šä¸»ä½“çŠ¶æ€çš„è®¾ç½®ï¼Œå³æ›´æ”¹ä¸»ä½“çš„çŠ¶æ€æŒ‡å‘å¯¹åº”çš„çŠ¶æ€å®ä¾‹
    handle(context) {
        console.log(`turn to ${this.color} hight`)
        context.setState(this)
    }

}
// ä¸»ä½“
class Context {
    constructor() {
        this.state = null
    }
    // 
    init(){
      // åœ¨è¿™å¯ä»¥åšä¸€äº›çŠ¶æ€æœºçš„å§”æ‰˜äº‹ä»¶ã€ä¸»ä½“çš„ä¸€äº›åˆå§‹åŒ–ã€‚è§†åº”ç”¨åœºæ™¯è€Œå®šã€‚
    }
    // è·å–å½“å‰çš„ä¸»ä½“çŠ¶æ€
    getState() {
        return this.state
    }
     // è®¾ç½®å½“å‰çš„ä¸»ä½“çŠ¶æ€
    setState(state) {
        this.state = state
    }
}
//æµ‹è¯•
let context = new Context()
let red = new State('red')
let yellow = new State('yellow')

red.handle(context)
console.log(context.getState())
yellow.handle(context)
console.log(context.getState())

```

### æ³¨æ„äº‹é¡¹ä»¥åŠä¼˜åŒ–æ–¹å‘

+ ç®¡ç†çŠ¶æ€å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ï¼š1ã€å½“çŠ¶æ€å¯¹è±¡Stateæ¯”è¾ƒåºå¤§çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©åœ¨éœ€è¦çš„æ—¶å€™åˆ›å»ºå¹¶éšåé”€æ¯ï¼›2ã€å½“çŠ¶æ€æ”¹å˜é¢‘ç¹çš„æ—¶å€™ï¼Œä¸€å¼€å§‹å°±åˆ›å»ºæ‰€æœ‰å¯¹è±¡ï¼Œå¹¶ä¸”å§‹ç»ˆä¸è¿›è¡Œé”€æ¯
+ åˆ©ç”¨äº«å…ƒæ¨¡å¼å…±äº«ä¸€ä¸ªstateå¯¹è±¡

## å…­ã€ä»£ç†æ¨¡å¼

### ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼

  åœ¨ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»ä»£è¡¨å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ã€‚

  åœ¨ä»£ç†æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºå…·æœ‰ç°æœ‰å¯¹è±¡çš„å¯¹è±¡ï¼Œä»¥ä¾¿å‘å¤–ç•Œæä¾›åŠŸèƒ½æ¥å£ã€‚

### ä»£ç å®ç°

```javascript
// æ¡ˆä¾‹1
//é¡µé¢æ»šåŠ¨ä¸‹å®ç° å›¾ç‰‡é¢„åŠ è½½å’Œæ‡’åŠ è½½ä»£ç†; 

// åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰ç°æœ‰å¯¹è±¡çš„å¯¹è±¡
var insertImg = (function () {
      var result = null;
      return function (id, src) {
          if (result) {
              return result;
          }
          var img = new Image()
          this.setSrc = function (src) {
              img.src = src;
          }
          document.getElementById(id).appendChild(img);
          result = this;
      }
  })()
  document.onscroll = function () {
    var oTop = demo.offsetTop;
    if (window.pageYOffset >= oTop) {
      //çœŸæ­£çš„éœ€è¦åŠ è½½çš„å›¾ç‰‡
      proxy('https://xxx.imgurl.png')
    }
  }

var proxy =(function(){//å½“äº‹ä»¶è§¦å‘æ—¶å€™,æ‰å»æ‰§è¡Œproxyè¯·æ±‚å›¾ç‰‡,æ˜¯æ‡’åŠ è½½
    var oImg = new insertImg('demo',);//å¦‚æœæœ‰å¤šä¸ªéœ€è¦æ’å…¥å›¾ç‰‡çš„div,demoä¸èƒ½å†™æ­»
    oImg.setSrc('https://å ä½å›¾ç‰‡.png');//å ä½å›¾ç‰‡,èµ„æºä¸€æ—¦è¯·æ±‚è¿‡,å­˜åœ¨ç¼“å­˜é‡Œ,å…¶ä»–çš„divä¹Ÿç”¨
    
    //è¿™æ®µä»£ç æ˜¯é¢„åŠ è½½,è®¾å®šäº†ä¸€ä¸ªå‚€å„¡å›¾ç‰‡,å‚€å„¡å›¾ç‰‡çš„ä½œç”¨æ˜¯è¯·æ±‚çœŸæ­£çš„å›¾ç‰‡èµ„æº,å½“èµ„æºè¯·æ±‚å®Œæˆåå°±ä¸€æ¬¡æ€§æ¸²æŸ“åˆ°domé‡Œ
    return function(src){
          var myImg = new Image();
          myImg.onload = function () {
              oImg.setSrc(src)
          }
          myImg.src = src;
    }
})() 

// æ¡ˆä¾‹2
// google æœåŠ¡å™¨é€šè¿‡ä¸­é—´æœåŠ¡å™¨ä»£ç†

class Google {
  get(url) {
    return 'google';
  }
}
class Proxy {
  constructor(url) {
    this.google = new Google(url);
  }
  get(url) {
    return this.google.get(url); //é€šè¿‡ä»£ç†è·å–googleæœåŠ¡å™¨ä¸­çš„æ•°æ®
  }
}
let proxy = new Proxy();
let res = proxy.get('http://www.google.com';);
console.log(res);

```

## ä¸ƒã€ç­–ç•¥æ¨¡å¼


### ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼

  å°†ç®—æ³•çš„ä½¿ç”¨ä¸ç®—æ³•çš„å®ç°åˆ†ç¦»å¼€

  è¯¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒé€šè¿‡å¯¹ç®—æ³•è¿›è¡Œå°è£…ï¼ŒæŠŠä½¿ç”¨ç®—æ³•çš„è´£ä»»å’Œç®—æ³•çš„å®ç°åˆ†å‰²å¼€æ¥ï¼Œå¹¶å§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡å¯¹è¿™äº›ç®—æ³•è¿›è¡Œç®¡ç†ã€‚æ­¤ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼å¤„å¼•ç”¨äº† gof è®¾è®¡æ¨¡å¼çš„æè¿°ã€‚

### æœ‰å•¥ä¼˜ç‚¹

- å¤šé‡æ¡ä»¶è¯­å¥ä¸æ˜“ç»´æŠ¤ï¼Œè€Œä½¿ç”¨ç­–ç•¥æ¨¡å¼**å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶è¯­å¥**ã€‚
- ç­–ç•¥æ¨¡å¼æä¾›äº†ä¸€ç³»åˆ—çš„å¯ä¾›é‡ç”¨çš„ç®—æ³•ï¼Œæ°å½“ä½¿ç”¨ç»§æ‰¿å¯ä»¥æŠŠç®—æ³•æ—çš„å…¬å…±ä»£ç è½¬ç§»åˆ°çˆ¶ç±»é‡Œé¢ï¼Œä»è€Œ**é¿å…é‡å¤çš„ä»£ç **ã€‚
- ç­–ç•¥æ¨¡å¼å¯ä»¥æä¾›ç›¸åŒè¡Œä¸ºçš„ä¸åŒå®ç°ï¼Œ**å®¢æˆ·å¯ä»¥æ ¹æ®ä¸åŒæ—¶é—´æˆ–ç©ºé—´è¦æ±‚é€‰æ‹©ä¸åŒçš„**ã€‚
- ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œ**å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸä»£ç çš„æƒ…å†µä¸‹ï¼Œçµæ´»å¢åŠ æ–°ç®—æ³•**ã€‚
- ç­–ç•¥æ¨¡å¼æŠŠç®—æ³•çš„ä½¿ç”¨æ”¾åˆ°ç¯å¢ƒç±»ä¸­ï¼Œè€Œç®—æ³•çš„å®ç°ç§»åˆ°å…·ä½“ç­–ç•¥ç±»ä¸­ï¼Œå®ç°äº†äºŒè€…çš„**åˆ†ç¦»ã€‚**


### å…¶ä»–

å¯ä»¥è€ƒè™‘ mapå¯¹è±¡

### ä»£ç å®ç°

``` javascript
const orderType = 1 // 1: ç¾å¦†ï¼Œ2ï¼šç”µå™¨ï¼Œ3ï¼šå®¶å…·
const orderWay = 2 // 1ï¼šh5ï¼Œ2ï¼šappï¼Œ3ï¼šå°ç¨‹åº

const strategy = () => { // è®¢å•ç±»å‹+ç¯å¢ƒç±»å‹ç­–ç•¥
  const map = new Map([
    [{
      orderType: 1,
      orderWay: 1
    }, () => {
      console.log('ç¾å¦†è®¢å•h5')
    }],
    [{
      orderType: 1,
      orderWay: 2
    }, () => {
      console.log('ç¾å¦†è®¢å•app')
    }],
    [{
      orderType: 1,
      orderWay: 3
    }, () => {
      console.log('ç¾å¦†è®¢å•å°ç¨‹åº')
    }],
    [{
      orderType: 2,
      orderWay: 1
    }, () => {
      console.log('ç”µå™¨è®¢å•h5')
    }],
    [{
      orderType: 2,
      orderWay: 2
    }, () => {
      console.log('ç”µå™¨è®¢å•app')
    }],
    [{
      orderType: 2,
      orderWay: 3
    }, () => {
      console.log('ç”µå™¨è®¢å•å°ç¨‹åº')
    }],
    [{
      orderType: 3,
      orderWay: 1
    }, () => {
      console.log('å®¶å…·è®¢å•h5')
    }],
    [{
      orderType: 3,
      orderWay: 2
    }, () => {
      console.log('å®¶å…·è®¢å•app')
    }],
    [{
      orderType: 3,
      orderWay: 3
    }, () => {
      console.log('å®¶å…·è®¢å•å°ç¨‹åº')
    }],
  ])
  return map
}

const run = (orderType, orderWay) => {
  let action = [...strategy()].filter(([key, value]) => (key.orderType === orderType && key.orderWay === orderWay))
  action.forEach(([key, value]) => value.call(this))
}

run(orderType, orderWay)
```
### å‚è€ƒæ¡ˆä¾‹

+ [å‰ç«¯è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼](https://www.jianshu.com/p/e08125318bfa)


## å…«ã€èŒè´£é“¾æ¨¡å¼

### æ˜¯ä¹ˆæ˜¯èŒè´£é“¾æ¨¡å¼

  - ç±»ä¼¼å¤šç±³è¯ºéª¨ç‰Œ, é€šè¿‡è¯·æ±‚ç¬¬ä¸€ä¸ªæ¡ä»¶, ä¼šæŒç»­æ‰§è¡Œåç»­çš„æ¡ä»¶, ç›´åˆ°è¿”å›ç»“æœä¸ºæ­¢ã€‚
  ç›¸å½“äºå¯¹if-elseæ¡ä»¶åˆ¤æ–­è¿‡å¤šçš„è¯­å¥è¿›è¡Œä¼˜åŒ–

  - ä¸ºé¿å…è¯·æ±‚å‘é€è€…å’Œå¤šä¸ªè¯·æ±‚å¤„ç†è€¦åˆåœ¨ä¸€èµ·ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å¤„ç†è€…é€šè¿‡å‰ä¸€å¯¹è±¡è®°ä½å…¶ä¸‹ä¸€å¯¹è±¡çš„å¼•ç”¨è€Œè¿æˆä¸€æ¡é“¾è·¯ã€‚å½“è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œå¯ä»¥å°†è¯·æ±‚æ²¿ç€è¿™æ¡é“¾è·¯ä¼ é€’ï¼ŒçŸ¥é“å¯¹è±¡å¤„ç†ä»–ä¸ºæ­¢ã€‚


### ä»£ç å®ç°

```javascript
// åœºæ™¯: æŸç”µå•†é’ˆå¯¹å·²ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·æœ‰ä¼˜æƒ æ”¿ç­–, åœ¨æ­£å¼è´­ä¹°å, 
// å·²ç»æ”¯ä»˜è¿‡ 500 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ° 100 å…ƒçš„ä¼˜æƒ åˆ¸, 200 å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ° 50 å…ƒä¼˜æƒ åˆ¸,
//  æ²¡æœ‰æ”¯ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·åªèƒ½æ­£å¸¸è´­ä¹°ã€‚

// orderType: è¡¨ç¤ºè®¢å•ç±»å‹, 1: 500 å…ƒå®šé‡‘ç”¨æˆ·ï¼›2: 200 å…ƒå®šé‡‘ç”¨æˆ·ï¼›3: æ™®é€šè´­ä¹°ç”¨æˆ·
// pay: è¡¨ç¤ºç”¨æˆ·æ˜¯å¦å·²ç»æ”¯ä»˜å®šé‡‘, true: å·²æ”¯ä»˜ï¼›false: æœªæ”¯ä»˜
// stock: è¡¨ç¤ºå½“å‰ç”¨äºæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜æ•°é‡, å·²æ”¯ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·ä¸å—æ­¤é™åˆ¶

// ä¸šåŠ¡ä»£ç 
const order500 = function(orderType, pay, stock) {
  if ( orderType === 1 && pay === true ) {
    console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 å…ƒä¼˜æƒ åˆ¸')
  } else {
    return 'nextSuccess'
  }
}
 
const order200 = function(orderType, pay, stock) {
  if ( orderType === 2 && pay === true ) {
    console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 å…ƒä¼˜æƒ åˆ¸')
  } else {
    return 'nextSuccess'
  }
}
 
const orderCommon = function(orderType, pay, stock) {
  if (orderType === 3 && stock > 0) {
    console.log('æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸')
  } else {
    console.log('åº“å­˜ä¸å¤Ÿ, æ— æ³•è´­ä¹°')
  }
}
 
// é“¾è·¯ä»£ç 
const chain = function(fn) {
  this.fn = fn
  this.sucessor = null
}
 
chain.prototype.setNext = function(sucessor) {
  this.sucessor = sucessor
}
 
chain.prototype.init = function() {
  const result = this.fn.apply(this, arguments)
  if (result === 'nextSuccess') {
    this.sucessor.init.apply(this.sucessor, arguments)
  }
}
 
const order500New = new chain(order500)
const order200New = new chain(order200)
const orderCommonNew = new chain(orderCommon)
 
order500New.setNext(order200New)
order200New.setNext(orderCommonNew)
 
order500New.init( 3, true, 500 ) // æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸

// å¯ä»¥ç»“åˆAOPè®¾è®¡æ¨¡å¼è¿›è¡Œä¼˜åŒ–
// é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_33698043/article/details/91401358

```

## ä¹ã€äº«å…ƒæ¨¡å¼

### ä»€ä¹ˆæ˜¯äº«å…ƒæ¨¡å¼

  äº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§ä¼˜åŒ–ç¨‹åºæ€§èƒ½çš„æ¨¡å¼, æœ¬è´¨ä¸ºå‡å°‘å¯¹è±¡åˆ›å»ºçš„ä¸ªæ•°ã€‚ 

  ä»¥ä¸‹æƒ…å†µå¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼:

    æœ‰å¤§é‡ç›¸ä¼¼çš„å¯¹è±¡, å ç”¨äº†å¤§é‡å†…å­˜
    å¯¹è±¡ä¸­å¤§éƒ¨åˆ†çŠ¶æ€å¯ä»¥æŠ½ç¦»ä¸ºå¤–éƒ¨çŠ¶æ€
### äº«å…ƒæ¨¡å¼å’Œå¯¹è±¡æ± çš„åŒºåˆ«

1. åˆ›å»ºç‰©ä½“çš„æ–¹å¼

   + å¯¹è±¡æ± ï¼š åˆ›å»ºä¸€ä¸ªæ–°ç‰©ä½“æ—¶ä¼šå…ˆåœ¨å¯¹è±¡æ± ä¸­å¯»æ‰¾éœ€è¦çš„å¯¹è±¡ï¼Œå¦‚æœæœ‰ç›´æ¥å–æ¥åˆå§‹åŒ–åå°±ç”¨ï¼Œæ²¡æœ‰å°±ç›´æ¥åˆ›å»ºæ–°çš„
   + äº«å…ƒæ¨¡å¼ï¼šåœ¨äº«å…ƒå·¥å‚ä¸­å¯»æ‰¾éœ€è¦çš„å¯¹è±¡ï¼Œ**ä»…ä»…ä¿®æ”¹ç‰©ä½“çš„å¤–éƒ¨å±æ€§**

2. æ‰€åˆ›ç‰©ä½“ç‰¹ç‚¹

   + å¯¹è±¡æ± ï¼š å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡ï¼Œæœ‰ç€è‡ªå·±çš„å±æ€§å’Œè¡Œä¸º
   + äº«å…ƒæ¨¡å¼ï¼š åªæœ‰è‡ªå·±ç‹¬ç«‹çš„éƒ¨åˆ†å±æ€§ï¼ˆå¤–éƒ¨å±æ€§ï¼‰ã€‚ä¸€èˆ¬ä¸å»ä¿®æ”¹å†…éƒ¨å±æ€§å’Œè¡Œä¸º

3. å¯¹è±¡å…±äº«æ–¹å¼

    + å¯¹è±¡æ± ï¼šæ± åŒ–æŠ€æœ¯ä¸­çš„â€œå¤ç”¨â€å¯ä»¥ç†è§£ä¸ºâ€œé‡å¤ä½¿ç”¨â€ï¼Œ**ä¸»è¦ç›®çš„æ˜¯èŠ‚çœæ—¶é—´**ï¼ˆåå¤åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ—¶é—´ï¼‰ã€‚
    + äº«å…ƒæ¨¡å¼ï¼š äº«å…ƒæ¨¡å¼ä¸­çš„â€œå¤ç”¨â€å¯ä»¥ç†è§£ä¸ºâ€œå…±äº«ä½¿ç”¨â€ï¼Œ**ä¸»è¦ç›®çš„æ˜¯èŠ‚çœç©ºé—´**


### å‚è€ƒé“¾æ¥

[jsè®¾è®¡æ¨¡å¼ä¹‹äº«å…ƒæ¨¡å¼](https://blog.csdn.net/SK_study/article/details/122503112)
## åã€ç»„åˆæ¨¡å¼

### ç‰¹ç‚¹

    ç»„åˆæ¨¡å¼åœ¨å¯¹è±¡é—´å½¢æˆæ ‘å½¢ç»“æ„;

    ç»„åˆæ¨¡å¼ä¸­åŸºæœ¬å¯¹è±¡å’Œç»„åˆå¯¹è±¡è¢«ä¸€è‡´å¯¹å¾…;

    æ— é¡»å…³å¿ƒå¯¹è±¡æœ‰å¤šå°‘å±‚, è°ƒç”¨æ—¶åªéœ€åœ¨æ ¹éƒ¨è¿›è¡Œè°ƒç”¨;

## å…¶ä»–è®¾è®¡æ¨¡å¼

+ å‘½ä»¤æ¨¡å¼
+ æ¨¡æ¿æ–¹æ³•æ¨¡å¼
+ å†…éƒ¨è¿­ä»£å™¨

## å‚è€ƒæ–‡æ¡£

+ [JSçš„å‘å¸ƒè®¢é˜…æ¨¡å¼](https://www.cnblogs.com/suyuanli/p/9655699.html)
+ [JSè®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆæ ¸å¿ƒï¼‰](https://www.jianshu.com/p/ccd893c84424)
+ ğŸ‘Œ é½å…¨ [å‰ç«¯é¢è¯•ä¹‹JavaScriptè®¾è®¡æ¨¡å¼](https://blog.csdn.net/weixin_33698043/article/details/91401358)

+ é½å…¨ [å‰ç«¯æŠ€æœ¯ä½“ç³»](https://www.yuque.com/surfacew/ggwv30/fs5h7r)