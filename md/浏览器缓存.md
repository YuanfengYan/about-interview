# æµè§ˆå™¨ç¼“å­˜
## åŸºç¡€æ¦‚å¿µï¼š

  [ç¼“å­˜å­˜åœ¨é‚£äº›ä½ç½®ï¼Ÿç¼“å­˜ä½ç½®å¯åˆ†Service Workerã€Memory Cacheã€Disk Cacheã€Push Cacheå››ç§](https://blog.csdn.net/m0_37217612/article/details/107942864)

    å¾ˆå¤šæ—¶å€™ï¼Œå¤§å®¶å€¾å‘äºå°†æµè§ˆå™¨ç¼“å­˜ç®€å•åœ°ç†è§£ä¸ºâ€œHTTP ç¼“å­˜â€ã€‚ä½†äº‹å®ä¸Šï¼Œæµè§ˆå™¨ç¼“å­˜æœºåˆ¶æœ‰å››ä¸ªæ–¹é¢ï¼Œå®ƒä»¬æŒ‰ç…§è·å–èµ„æºæ—¶è¯·æ±‚çš„ä¼˜å…ˆçº§ä¾æ¬¡æ’åˆ—å¦‚ä¸‹

  - 1 Service Worker -- Service Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨èƒŒåçš„ç‹¬ç«‹çº¿ç¨‹ï¼Œä¼ è¾“åè®®å¿…é¡»ä¸º HTTPS [æµè§ˆå™¨ç¼“å­˜ä¹‹httpç¼“å­˜å’Œservice worker](https://blog.csdn.net/u010674395/article/details/106981924/)

  - 2 Memory Cache å†…å­˜

  - 3 Disk Cache ç¡¬ä»¶

  - 4 Push Cache

====
====


+ HTTPé“¾ä¸Šçš„ç¼“å­˜ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¸€èˆ¬æŒ‡æµè§ˆå™¨çš„ç¼“å­˜ç³»ç»Ÿï¼Œå’Œä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ã€‚

+ HTTPåè®®çš„Cache -ControlæŒ‡å®šè¯·æ±‚å’Œå“åº”éµå¾ªçš„ç¼“å­˜æœºåˆ¶ã€‚åœ¨è¯·æ±‚æ¶ˆæ¯æˆ–å“åº”æ¶ˆæ¯ä¸­è®¾ç½® Cache-Controlå¹¶ä¸ä¼šå½±å“å¦ä¸€ä¸ªæ¶ˆæ¯å¤„ç†è¿‡ç¨‹ä¸­çš„ç¼“å­˜å¤„ç†è¿‡ç¨‹ã€‚

  >å³æ¯”å¦‚ï¼šå‰ç«¯è¯·æ±‚å¤´ä¸­ä¹Ÿå¯ä»¥ä¿®æ”¹Cache-Controlä»¥è¡¨è¾¾å‰ç«¯åº”ç”¨ä¸­å¸Œæœ›çš„ç¼“å­˜ç­–ç•¥ï¼Œå³å¯ä»¥å¼ºåˆ¶ç»•è¿‡æµè§ˆå™¨ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æœåŠ¡å™¨ä¸Šçš„æœ€æ–°èµ„æºã€‚ä½†è¿™å¹¶ä¸ä¸€å®šå½±å“ç›¸åº”å¤´ä¸­çš„Cache-Controlã€‚

## å…³äºcache-controlæ˜¯å‡ºç°åœ¨responseè¿˜æ˜¯requestçš„åŒºåˆ«

### cache-controlå‡ºç°åœ¨requestä¸­ï¼š

+ cache-control:no-cache å‘Šè¯‰HTTPæ¶ˆæ¯é“¾ä¸Šçš„ç¼“å­˜ç³»ç»Ÿ(ä¹Ÿå°±æ˜¯æµè§ˆå™¨çš„ç¼“å­˜å’Œä»£ç†æœåŠ¡å™¨ä¸Šçš„ç¼“å­˜)ï¼Œæœ¬æ¬¡è¯·æ±‚è¦æ±‚å¿½ç•¥ä¸€é½ç¼“å­˜ï¼Œå¿…é¡»æ˜¯åŸå§‹æœåŠ¡å™¨é‡æ–°è®¡ç®—ç”Ÿæˆå›åº”ç»™ç”¨æˆ·ã€‚æ‰€ä»¥ï¼Œå³ä½¿æµè§ˆå™¨ä¸Šçš„æœ¬åœ°ç¼“å­˜æœªè¿‡æœŸï¼Œæˆ–è€…ä»£ç†æœåŠ¡å™¨ä¸Šçš„ç¼“å­˜æœªè¿‡æœŸï¼Œéƒ½ä¸è¦å°†è¿™äº›ç¼“å­˜ä½œä¸ºå›åº”ã€‚å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­å¼ºåˆ¶åˆ·æ–°é¡µé¢ï¼ˆæŒ‰ctrl+F5ï¼‰ï¼Œå‘é€çš„å°±æ˜¯è¿™ä¸ªå¤´ï¼ˆä¸åŒå¾ˆå¤šæµè§ˆå™¨å°†cache-contro:no-cachelå’Œpragam:no-cacheä¸¤ä¸ªå¤´ä¸€èµ·å‘é€ï¼‰

+ pragma:no-cacheï¼šå’Œcache-control:no-cacheä¸€æ ·ï¼Œä¸è¿‡å‡ºäºå…¼å®¹HTTP/1.0ï¼Œæ‰€ä»¥æœ‰äº›æµè§ˆå™¨ä¼šä¿ç•™è¿™ä¸ªå¤´ã€‚æ³¨æ„pragma:no-cacheåªåº”è¯¥å‡ºç°åœ¨Requestä¸­ï¼Œè¡¨æ˜ä¸æƒ³è·å–ç¼“å­˜ã€‚HTTPæ²¡æœ‰å“ªæ¡æ¡æ–‡å¯¹Responseä¸­çš„pragma:no-cacheè¿›è¡Œå®šä¹‰ï¼Œæ‰€ä»¥Responseä¸­çš„pragma:no-cacheæ˜¯æ— æ•ˆçš„ã€‚

### cache-controlå‡ºç°åœ¨responseä¸­:

+ cache-control:no-control æœåŠ¡å™¨å‘Šè¯‰HTTPæ¶ˆæ¯é“¾ä¸Šçš„ç¼“å­˜ç³»ç»Ÿï¼Œä¸è¦ç¼“å­˜è¿™ä¸ªresponseç»“æœã€‚å…¶å®è¿™ä¸ªä¸æ˜¯ç™¾åˆ†ç™¾è‚¯å®šï¼Œè€Œä¸”ä¸åŒæµè§ˆå™¨å¥½åƒæ¥æ”¶åˆ°è¿™ä¸ªå¤´æ—¶ä¹Ÿæœ‰ä¸åŒååº”ã€‚

### å…¶ä»–

    æœªæ‰¾åˆ°å–è¯

è€Œå¦å¤–ï¼Œcache-controlï¼šno-storeå‡ºç°åœ¨responseä¸­æ‰æœ‰æ„ä¹‰ï¼Œæ„æ€æ˜¯å‘Šè¯‰ç¼“å­˜ç³»ç»Ÿä¸è¦ç¼“å­˜æˆ–è€…å­˜å‚¨responseå†…å®¹ï¼ˆä¸è¦ä»»ä½•å½¢å¼çš„å­˜å‚¨ï¼ŒåŒ…æ‹¬å­˜å‚¨åœ¨ç¼“å­˜æ–‡ä»¶å¤¹ä¸­ï¼Œä»¥å…ä¸€äº›æ•æ„Ÿä¿¡æ¯å¤–æ³„ï¼‰ã€‚chrome,IE9,FFå¯¹è¿™ä¸ªå¤´çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚å½“æ¥æ”¶åˆ°æœ‰è¿™ä¸ªå¤´çš„responseï¼Œä¸‰ä¸ªæµè§ˆå™¨çš„ç¼“å­˜ç›®å½•éƒ½æ‰¾ä¸åˆ°ç›¸å…³çš„ç¼“å­˜æ–‡ä»¶ã€‚
  
  

## ä¸€ã€å¼ºåˆ¶ç¼“å­˜

>å…¶å®å¼ºæ˜¯å¼ºåˆ¶çš„æ„æ€ã€‚å½“æµè§ˆå™¨å»è¯·æ±‚æŸä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±åœ¨respone headeré‡Œé¢å¯¹è¯¥æ–‡ä»¶åšäº†ç¼“å­˜é…ç½®ã€‚ç¼“å­˜çš„æ—¶é—´ã€ç¼“å­˜ç±»å‹éƒ½ç”±æœåŠ¡ç«¯æ§åˆ¶

### cache-control

+ cache-control: max-age=xxxxï¼Œpublic  
å®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨éƒ½å¯ä»¥ç¼“å­˜è¯¥èµ„æºï¼›
å®¢æˆ·ç«¯åœ¨xxxç§’çš„æœ‰æ•ˆæœŸå†…ï¼Œå¦‚æœæœ‰è¯·æ±‚è¯¥èµ„æºçš„éœ€æ±‚çš„è¯å°±ç›´æ¥è¯»å–ç¼“å­˜,statu code:200 ï¼Œå¦‚æœç”¨æˆ·åšäº†åˆ·æ–°æ“ä½œï¼Œå°±å‘æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚

+ cache-control: max-age=xxxxï¼Œprivate  
åªè®©å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜è¯¥èµ„æºï¼›ä»£ç†æœåŠ¡å™¨ä¸ç¼“å­˜
å®¢æˆ·ç«¯åœ¨xxxç§’å†…ç›´æ¥è¯»å–ç¼“å­˜,statu code:200

+ cache-control: max-age=xxxxï¼Œimmutable  
å®¢æˆ·ç«¯åœ¨xxxç§’çš„æœ‰æ•ˆæœŸå†…ï¼Œå¦‚æœæœ‰è¯·æ±‚è¯¥èµ„æºçš„éœ€æ±‚çš„è¯å°±ç›´æ¥è¯»å–ç¼“å­˜,statu code:200 ï¼Œå³ä½¿ç”¨æˆ·åšäº†åˆ·æ–°æ“ä½œï¼Œä¹Ÿä¸å‘æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚

+ cache-control: no-cache  
è·³è¿‡è®¾ç½®å¼ºç¼“å­˜ï¼Œä½†æ˜¯ä¸å¦¨ç¢è®¾ç½®åå•†ç¼“å­˜ï¼›ä¸€èˆ¬å¦‚æœä½ åšäº†å¼ºç¼“å­˜ï¼Œåªæœ‰åœ¨å¼ºç¼“å­˜å¤±æ•ˆäº†æ‰èµ°åå•†ç¼“å­˜çš„ï¼Œè®¾ç½®äº†no-cacheå°±ä¸ä¼šèµ°å¼ºç¼“å­˜äº†ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å›è¯¢é—®æœåŠ¡ç«¯ã€‚

+ cache-control: no-store  
ä¸ç¼“å­˜ï¼Œè¿™ä¸ªä¼šè®©å®¢æˆ·ç«¯ã€æœåŠ¡å™¨éƒ½ä¸ç¼“å­˜ï¼Œä¹Ÿå°±æ²¡æœ‰æ‰€è°“çš„å¼ºç¼“å­˜ã€åå•†ç¼“å­˜äº†ã€‚

### Expires 

>ä¼˜å…ˆçº§è¾ƒcache-controlä½ä¸€ç‚¹

æ—¶é—´æ˜¯æœåŠ¡å™¨ç»å¯¹æ—¶é—´

## äºŒã€åå•†ç¼“å­˜

  ETagçš„ä¼˜å…ˆçº§æ¯”Last-Modifiedé«˜

### last-modified if-modified-since

ä¼˜ç‚¹ï¼šè€—è´¹èµ„æºå°‘
ç¼ºç‚¹ï¼šLast-Modifiedçš„ç²¾åº¦åªèƒ½åˆ°ç§’ï¼Œå¦‚æœä¸€ä¸ªèµ„æºé¢‘ç¹ä¿®æ”¹ï¼Œåœ¨åŒä¸€ç§’è¿›è¡Œå¤šæ¬¡ä¿®æ”¹ï¼Œä½ ä»Last-Modifiedä¸Šæ˜¯çœ‹ä¸å‡ºæ¥åŒºåˆ«çš„

#### å¯¹åº”çš„åœ¨æäº¤æ—¶ä½¿ç”¨çš„ï¼š

  If-Unmodified-Since
### etag if-none-matched

ä¼˜ç‚¹ï¼šä»–æ¯”Last-Modifiedç²¾åº¦é«˜ï¼Œæ›´å‡†ç¡®ã€‚
ç¼ºç‚¹ï¼šä½ çš„ETagå¦‚æœè®¾è®¡ä¸ºä¸€ä¸ªhashå€¼ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½è¦è®¡ç®—è¿™ä¸ªå€¼ï¼Œéœ€è¦é¢å¤–è€—è´¹æœåŠ¡å™¨èµ„æºã€‚

  æœåŠ¡ç«¯æ‹¿åˆ°å®¢æˆ·ç«¯è¯·æ±‚é‡Œé¢çš„If-None-Matchè·Ÿå½“å‰ç‰ˆæœ¬çš„ETagæ¯”è¾ƒä¸‹ï¼š

  >å¦‚æœæ˜¯ä¸€æ ·çš„è¯ï¼Œç›´æ¥è¿”å›304ï¼Œè¯­ä¹‰ä¸ºNot Modifiedï¼Œä¸è¿”å›å†…å®¹(body)ï¼Œåªè¿”å›headerï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ç”¨ç¼“å­˜
  >å¦‚æœä¸ä¸€æ ·çš„è¯ï¼Œè¿”å›200å’Œæœ€æ–°çš„å†…å®¹

#### å¯¹åº”çš„åœ¨æäº¤æ—¶ä½¿ç”¨çš„ï¼š

  request header----If-Match
  if-Matché€šå¸¸ç”¨äºpostæˆ–è€…putè¯·æ±‚ä¸­
  å¦‚æœå·²ç»æäº¤è¿‡äº†ï¼ŒIf-Matchå°±ä¸æˆç«‹äº†ï¼Œè¿™æ—¶å€™æœåŠ¡ç«¯ä¼šç»™ä½ è¿”å›412é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯Precondition Failedï¼Œå‰ææ¡ä»¶å¤±è´¥ã€‚

## ä¸‰ 200 or 304

åœ¨æ²¡æœ‰è®¾ç½®Cache-Controlçš„æƒ…å†µä¸‹ï¼Œè®¾ç½®Last-Modifiedå’ŒETagç¼“å­˜ï¼Œä¼šå‡ºç°200ï¼ˆfrom cacheï¼‰å’Œ304 äº¤æ›¿å‡ºç°çš„æƒ…å†µ

è®¾ç½®Cache-Controlçš„æƒ…å†µä¸‹ï¼Œè¿‡æœŸåˆ·æ–°ä¼šå‡ºç°304(å¦‚æœæœ‰æ›´æ–°å†…å®¹ï¼Œåˆ™æ˜¯200)ï¼Œä¹‹åå†è¿‡æœŸä¹‹å‰åˆ·æ–°éƒ½æ˜¯200ï¼ˆfrom cacheï¼‰ã€‚å¦‚æœè¦ç¡®ä¿è¦å‘æœåŠ¡ç«¯ç¡®è®¤ï¼Œå¯ä»¥å°†Cache-Contralçš„max-ageè®¾ç½®ä¸º0ã€‚
## å‚è€ƒæ–‡æ¡£

+ [å½»åº•å¼„æ‡‚å¼ºç¼“å­˜ä¸åå•†ç¼“å­˜](https://www.jianshu.com/p/9c95db596df5)
+ ğŸ‘ [è½»æ¾ç†è§£HTTPç¼“å­˜ç­–ç•¥](https://blog.csdn.net/dennis_jiang/article/details/111589275))
+ [requestçš„cache-controlå’Œresponse cache-controlä¸åŒç‚¹](https://blog.csdn.net/weixin_34221036/article/details/92032569)
+ [æµ…è°ˆhttpä¸­çš„Cache-Control](https://blog.csdn.net/u012375924/article/details/82806617)